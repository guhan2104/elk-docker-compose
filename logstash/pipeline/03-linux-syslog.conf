#################################################################
# logstash parsing logic and tagging for generic linux syslog   #
#################################################################

input {
  udp {
    port => 5144
      type => "syslog"
      tags => ["linux","system","syslog","generic"] 
  }
}
filter {
  if "linux" in [tags] {
    mutate {
      gsub => [
        "message", "^<[0-9][0-9][0-9]>", ""]
    }
    kv { }
  }
}
output {
#  stdout { codec => rubydebug }
  elasticsearch {
    hosts => [ "elasticsearch:9200" ]
      index => "linux-syslog-%{+YYYY.MM.dd}"
  }
}
